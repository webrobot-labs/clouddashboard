"use strict";(()=>{var e={};e.id=555,e.ids=[555],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},61282:e=>{e.exports=require("child_process")},84770:e=>{e.exports=require("crypto")},17702:e=>{e.exports=require("events")},32615:e=>{e.exports=require("http")},35240:e=>{e.exports=require("https")},21764:e=>{e.exports=require("util")},72933:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>m,patchFetch:()=>g,requestAsyncStorage:()=>d,routeModule:()=>p,serverHooks:()=>h,staticGenerationAsyncStorage:()=>l});var s={};t.r(s),t.d(s,{POST:()=>u});var i=t(73278),a=t(45002),o=t(54877),n=t(71309);let c=new(t(47718)).Z(process.env.STRIPE_SECRET_KEY,{apiVersion:"2024-09-30.acacia"});async function u(e){try{let{amount:r}=await e.json(),t=`${r} Credits Subscription`,s=await c.products.search({query:`name:'${t}'`}),i="";if(i=s?.data?.length>0&&s.data[0]?s.data[0].id:(await c.products.create({name:t,description:`${r} credits per month subscription`})).id){let e=await c.prices.list({product:i,active:!0}),t="";if(t=e?.data?.length>0&&e.data[0]?e.data[0].id:(await c.prices.create({product:i,unit_amount:100*r,currency:"usd",recurring:{interval:"month"}})).id){let e=await c.checkout.sessions.create({mode:"subscription",payment_method_types:["card"],line_items:[{price:t,quantity:1}],success_url:`${process.env.NEXTAUTH_URL}/Credits`,cancel_url:`${process.env.NEXTAUTH_URL}/Credits`});return n.NextResponse.json({id:e.id})}}return n.NextResponse.json({error:"Failed to create session"},{status:500})}catch(e){return console.error("Error creating subscription session:",e),n.NextResponse.json({error:"Failed to create subscription session"},{status:500})}}let p=new i.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/create-recurring-session/route",pathname:"/api/create-recurring-session",filename:"route",bundlePath:"app/api/create-recurring-session/route"},resolvedPagePath:"/home/roger/github/clouddashboard/app/api/create-recurring-session/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:d,staticGenerationAsyncStorage:l,serverHooks:h}=p,m="/api/create-recurring-session/route";function g(){return(0,o.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:l})}}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[379,833,718],()=>t(72933));module.exports=s})();